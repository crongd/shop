<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shop.mappers.OrderMapper" >

    <insert id="create_order" parameterType="com.shop.dto.shopping.OrderDTO">
        insert into `order` values
        (
            #{merchantUid},
            #{impUid},
            #{user.id},
            #{buyerAddr},
            #{buyerPostcode},
            #{amount},
            #{currency},
            #{startedAt},
            #{paidAt},
            now(),
            #{cardQuota},
            #{payMethod},
            #{pgProvider},
            #{cardType},
            #{cardName},
            #{cardNumber},
            #{pgId}
        )
    </insert>

    <insert id="create_order_cart" >
        insert into `order_cart`(order_id, cart_no) values
        <foreach collection="shoppingCarts" item="shoppingCart" separator="," >
            (#{merchantUid}, #{shoppingCart.no})
        </foreach>
    </insert>

<!--    <select id="get_order" resultMap="" >-->

<!--    </select>-->

    <select id="get_request_price" resultType="int" >
        select sum(p.price * amount) as price from product p inner join shopping_cart sc on p.no = sc.product_no
        <trim prefix="where" prefixOverrides="and | or">
            <foreach collection="list" item="no" separator="or">
                sc.no=#{no}
            </foreach>
        </trim>
    </select>


</mapper>